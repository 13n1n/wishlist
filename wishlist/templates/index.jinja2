<!doctype html>
<html>
    <head>
        <title>Wishlist</title>
        <link rel="icon" href="data:image/x-icon;base64,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" type="image/png" />
        <link rel="stylesheet" href="https://cdn.getwirefy.com/wirefy.css">

        <style>
body {
    margin: 12em 6em 12em 0em;
    font-size: 18pt;
}

body * {
    margin: 0px;
    padding: 0px;
}

iframe {
    margin: auto;
    display: block;
}

p {
    display: block;
    width: 600px;
    margin: auto;
}

form {
    display: block;
    width: 600px;
    margin: 0.2em auto;
}

form > * {
    height: 22pt;
    display: inline;
}

input {
    width: 85%;
}

button {
    border: 1px solid #ddd;
    background-color: #f0f0f0;
    width: calc(15% - 10px);

    -o-transition: background-color .2s ease-in;
    -moz-transition: background-color .2s ease-in;
    -webkit-transition: background-color .2s ease-in;
    transition: background-color .2s ease-in;
}

button:hover {
    background-color: #e5e5e5;
}

button:active {
    background-color: #ccc;
}
        </style>
    </head>

    <body>
        {% if not env["user_id"] %}
            <script async src="https://telegram.org/js/telegram-widget.js?21" data-bot-id="{{BOT_ID}}" data-telegram-login="{{BOTNAME}}" data-size="large" data-auth-url="login" data-request-access="write"></script>
        {% else %}
            <p>
                Вы вошли как {{env['name']}}!
                <a href="/logout">Выйти c аккаунта</a>
                <a href="/{{env['user_id']}}">Бегом к себе</a>
            </p>

            <form action="/bio" method="post">
                <textarea name="bio" style="height: 60pt; width: 100%">{{ env["bio"] | safe }}</textarea>
                <button type="submit"> Update Bio </button>
            </form>

            {% if env["id"] == env["user_id"] %}
                <form action="/wish" method="post">
                    <input name="text" type="text" placeholder="Type Your Wish" />
                    <button type="submit">New</button>
                </form>
            {% endif %}
        {% endif %}

        {% for wish in env.get('wishlist', []) %}
            <form action="/wish/{{ wish.id }}" method="post">
                <input name="text" type="text" placeholder="Leave empty to remove" value="{{ wish.text }}" />
                {% set disabled = not env["user_id"] or (int(env["user_id"]) != wish.taken_id and wish.taken_id is not none) %}
                <button {% if disabled %} disabled {% endif %} type="submit">
                    {% if env["user_id"] == wish.owner_id %}
                        Update
                    {% else %}
                        {% if env["user_id"] == wish.taken_id %}
                            Forgive
                        {% elif wish.taken_id is none %}
                            Take
                        {% else %}
                            Already
                        {% endif %}
                    {% endif %}
                </button>
            </form>
        {% endfor %}
    </body>
</html>